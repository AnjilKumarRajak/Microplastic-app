import streamlit as st
import pandas as pd
import joblib

# Load models
models = {
    "Logistic Regression": joblib.load("models/lr_pipeline.joblib"),
    "SVM": joblib.load("models/svm_pipeline.joblib"),
    "KNN": joblib.load("models/knn_pipeline.joblib")
}

st.title("Microplastic Detection App")

# Model selector
model_choice = st.selectbox("Choose a model", list(models.keys()))
model = models[model_choice]

# Upload data
uploaded_file = st.file_uploader("Upload your CSV", type=["csv"])
if uploaded_file:
    data = pd.read_csv(uploaded_file)
    st.write("Preview of uploaded data:", data.head())

    if st.button("Predict"):
        try:
            predictions = model.predict(data)
            st.write("Predictions:", predictions)
        except Exception as e:
            st.error(f"Prediction failed: {e}")
